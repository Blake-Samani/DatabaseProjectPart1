<html>
    <head>
    <title>Administrator Page</title>
    </head>
            
    <body>
    
    
    <p> Welcome to the Administrator Page</p>

  

    <FORM name="Search" method="POST" action="searchuser.php"> 
        Search User ID: <INPUT type="text" name="clientid" required> 
        <INPUT type="submit" name="submit" value="Search"> 
    </FORM>
    <FORM name="Delete" method="POST" >
        Delete User: <INPUT type ="text" name="clientid" required>
        <INPUT type="submit" name="delete" value="Delete"> 
    </FORM>
   
    <form method="post"> 
        <input type="submit" name="button1"
                class="button" value="List All" /> 
    </form> 
    <FORM name="Add User" method="POST"> 
        Add User: <INPUT type="text" name="clientid" placeholder="user id" required>
            <INPUT type="password" name="passw" placeholder="password" required> 
                <INPUT type="text" name="fname" placeholder="first name" required> 
                    <INPUT type="text" name="lname" placeholder="last name" required> 
                        <INPUT type="text" name="accttype"placeholder="account type" required> 
                             
        <INPUT type="submit" name="usersubmit" value="Add"> 
    </FORM>

    <?php
      
    if(isset($_POST['button1'])) { 
        $connection = oci_connect ("gq008", "mjbrwe", "gqiannew2:1521/pdborcl");
        $query = "select * from pageuser";
        $cursor = oci_parse ($connection, $query);
        if ($cursor == false){
            // For oci_parse errors, pass the connection handle
            $e = oci_error($connection);  
            die($e['message']);
         }
         $result = oci_execute ($cursor);
        if ($result == false){
        
        $e = oci_error($cursor);  
        die($e['message']);
        }
        echo "<table border=1>";
            echo "<tr> <th>userid</th> <th>passw</th> <th>fname</th>" . 
                  "<th>lname</th> <th>accounttype</th> </tr>";
            
            // fetch the result from the cursor one by one
            while ($nuvalues = oci_fetch_array ($cursor)){
              $userid = $nuvalues[0];
              $passw = $nuvalues[1];
              $fname = $nuvalues[2];
              $lname = $nuvalues[3];
              $accounttype = $nuvalues[4];
            
              echo "<tr><td>$userid</td> <td>$passw</td> <td>$fname</td>" .
                    "<td>$lname</td> <td>$accounttype</td> </tr>";
            }
            
            echo "</table>";
            
            
            // free up resources used by the cursor
            oci_free_statement($cursor);
            
            // close the connection with oracle
            oci_close ($connection);
    } 
    if(isset($_POST['delete'])) { 
        $clientid = $_POST["clientid"];
        $connection = oci_connect ("gq008", "mjbrwe", "gqiannew2:1521/pdborcl");

        if ($connection == false){
   
        $e = oci_error(); 
        die($e['message']);
        }

        $query = "delete " .
        "from pageuser " .
        "where userid='$clientid' ";

        $cursor = oci_parse ($connection, $query);
        if ($cursor == false){
   
         $e = oci_error($connection);  
        die($e['message']);
        }

        $result = oci_execute ($cursor);
        if ($result == false){
   
         $e = oci_error($cursor);  
        die($e['message']);
        }

        oci_free_statement($cursor);
        oci_close ($connection);
    } 
    if(isset($_POST['usersubmit'])) { 
        $clientid = $_POST["clientid"];
        $password = $_POST["passw"];
        $firstname = $_POST["fname"];
        $lastname = $_POST["lname"];
        $accounttype = $_POST["accttype"];

        $connection = oci_connect ("gq008", "mjbrwe", "gqiannew2:1521/pdborcl");
        if ($connection == false){
   
        $e = oci_error(); 
        die($e['message']);
        }
        $query = "INSERT " .
        "INTO pageuser (userid, passw, fname, lname, accttype) " .
        "VALUES ('$clientid', '$password', '$firstname', '$lastname', '$accounttype')";

        $cursor = oci_parse ($connection, $query);
        if ($cursor == false){
        $e = oci_error($connection);  
        die($e['message']);
        }
        $result = oci_execute ($cursor);
        if ($result == false){
   
        $e = oci_error($cursor);  
        die($e['message']);
        }
        oci_free_statement($cursor);
        oci_close ($connection);
    }
   
?> 
  
    </body>
    </html>